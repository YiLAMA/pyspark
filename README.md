# pyspark
Pyspark
 
При работе с широтой и долготой, были замечены нулевые/пустые значения и странные координаты (ровно -1). Хоть и в условиях не было об этом сказано, я их убрал для корректного расчёта и надеюсь правильно сделал. 
 
Запуск в терминале работает: 
 
```
spark-submit spark.py
```
Местонахождение файл-данных должны быть такие для запуска в терминале 
 
```
file_crime = 'data/crime.csv'
file_offense_codes = 'data/offense_codes.csv'
```
Если будут проблемы с ними (возможно что-то не так загрузилось из-за большого размера), то лучше использовать датасеты из источника: 
https://www.kaggle.com/AnalyzeBoston/crimes-in-boston 
 
Путь к каталогу - где сохраняется сформированные данные в формате parquet 

```
path_save_folder = 'output/showcase_crime'
```
 
Итоговый вид полученных данных: 

```
+--------+------------+--------------+--------------------+------------------+------------------+
|DISTRICT|crimes_total|crimes_monthly|frequent_crime_types|               lat|               lng|
+--------+------------+--------------+--------------------+------------------+------------------+
|      A1|       35717|           904|PROPERTY, ASSAULT...|42.356733944169925|-71.06112996712561|
|     A15|        6505|           160|M/V ACCIDENT, INV...| 42.37599933215882|-71.06267564355912|
|      A7|       13544|           344|SICK/INJURED/MEDI...| 42.37735545951605|-71.03083363200777|
|      B2|       49945|          1298|M/V, M/V ACCIDENT...| 42.32162901059059|-71.08479984973216|
|      B3|       35442|           907|VERBAL DISPUTE, I...| 42.28691276523002|-71.08518799423317|
|     C11|       42530|          1115|M/V, SICK/INJURED...| 42.30005270854692|-71.06325855819784|
|      C6|       23460|           593|DRUGS, SICK/INJUR...|42.333628045765124|-71.05203273306276|
|     D14|       20127|           505|TOWED MOTOR VEHIC...| 42.35030978352097| -71.1422613535374|
|      D4|       41915|          1084|LARCENY SHOPLIFTI...| 42.34350022705704|-71.08090067663328|
|     E13|       17536|           445|SICK/INJURED/MEDI...|42.315022018702614|-71.10645084032734|
|     E18|       17348|           435|SICK/INJURED/MEDI...|  42.2626806112259|-71.11891998757716|
|      E5|       13239|           337|SICK/INJURED/MEDI...| 42.28247306566417|-71.14134995577206|
+--------+------------+--------------+--------------------+------------------+------------------+
```
 
